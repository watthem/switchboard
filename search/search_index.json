{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Switchboard","text":"<p>Governance protocol for AI agent fleets. Manages the boundary around agents \u2014 not the agents themselves.</p> <p>Any language. Any framework. Any runtime. Switchboard defines the contract: policy in, events out, enforcement at the infrastructure level.</p>"},{"location":"#what-switchboard-does","title":"What Switchboard Does","text":"<ol> <li>Registers agents and issues sidecar tokens</li> <li>Distributes policy (tier, allowed actions, rate limits) to agent sidecars</li> <li>Ingests events from agents via sidecars for audit trails</li> <li>Collects telemetry (RTT, jitter, runtime claims) for integrity scoring</li> <li>Serves a dashboard for fleet visibility and governance</li> </ol>"},{"location":"#architecture","title":"Architecture","text":"<pre><code>graph TD\n    CP[\"&lt;b&gt;Control Plane&lt;/b&gt;&lt;br/&gt;Dashboard \u00b7 Policy Editor \u00b7 Audit Log\"]\n    H[\"&lt;b&gt;Switchboard&lt;/b&gt;&lt;br/&gt;Governance Protocol Endpoint\"]\n\n    CP -- \"REST API\" --&gt; H\n\n    subgraph fleet [\"Agent Fleet\"]\n        direction LR\n\n        subgraph a1 [\"L0 \u00b7 Observer\"]\n            S1[\"Sidecar\"]\n            A1[\"Agent&lt;br/&gt;&lt;i&gt;Python&lt;/i&gt;\"]\n            S1 -. \"policy file\" .-&gt; A1\n            A1 -- \"events\" --&gt; S1\n        end\n\n        subgraph a2 [\"L1 \u00b7 Assistant\"]\n            S2[\"Sidecar\"]\n            A2[\"Agent&lt;br/&gt;&lt;i&gt;Ruby&lt;/i&gt;\"]\n            S2 -. \"policy file\" .-&gt; A2\n            A2 -- \"events\" --&gt; S2\n        end\n\n        subgraph a3 [\"L2 \u00b7 Operator\"]\n            S3[\"Sidecar\"]\n            A3[\"Agent&lt;br/&gt;&lt;i&gt;Go&lt;/i&gt;\"]\n            S3 -. \"policy file\" .-&gt; A3\n            A3 -- \"events\" --&gt; S3\n        end\n\n        subgraph a4 [\"L3 \u00b7 Autonomous\"]\n            S4[\"Sidecar\"]\n            A4[\"Agent&lt;br/&gt;&lt;i&gt;any&lt;/i&gt;\"]\n            S4 -. \"policy file\" .-&gt; A4\n            A4 -- \"events\" --&gt; S4\n        end\n    end\n\n    H -- \"policy + telemetry\" --&gt; S1\n    H -- \"policy + telemetry\" --&gt; S2\n    H -- \"policy + telemetry\" --&gt; S3\n    H -- \"policy + telemetry\" --&gt; S4\n\n    S1 -- \"events + heartbeats\" --&gt; H\n    S2 -- \"events + heartbeats\" --&gt; H\n    S3 -- \"events + heartbeats\" --&gt; H\n    S4 -- \"events + heartbeats\" --&gt; H</code></pre> <p>Each agent runs with a sidecar \u2014 a lightweight process that handles all Switchboard protocol communication. The agent only needs to:</p> <ol> <li>Read a local policy file (written by the sidecar)</li> <li>POST events to localhost (forwarded by the sidecar to Switchboard)</li> </ol>"},{"location":"#quick-start","title":"Quick Start","text":"<pre><code>git clone https://github.com/watthem/switchboard.git\ncd switchboard\npython -m venv .venv &amp;&amp; source .venv/bin/activate\npip install -e .\nuvicorn switchboard.app:app --port 59237\n</code></pre> <p>Then open http://localhost:59237/dashboard.</p> <p>See the full Quickstart guide for agent registration and integration.</p>"},{"location":"#integrate-your-agent-3-lines","title":"Integrate Your Agent (3 Lines)","text":"<p>Your agent reports events to the sidecar at <code>http://localhost:9100/events</code>:</p> PythonRubycurl <pre><code>import httpx\ndef report(action, target, result=\"success\"):\n    httpx.post(\"http://localhost:9100/events\", json={\n        \"action\": action, \"target\": target, \"result\": result,\n    })\n</code></pre> <pre><code>require 'net/http'; require 'json'\ndef report(action, target, result = \"success\")\n  Net::HTTP.post(URI(\"http://localhost:9100/events\"),\n    { action: action, target: target, result: result }.to_json,\n    \"Content-Type\" =&gt; \"application/json\")\nend\n</code></pre> <pre><code>curl -X POST http://localhost:9100/events \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"action\":\"test\",\"target\":\"test\",\"result\":\"success\"}'\n</code></pre>"},{"location":"#license","title":"License","text":"<p>MIT</p>"},{"location":"ARCHITECTURE/","title":"Switchboard \u2014 Architecture Overview","text":"<p>Stage: Pre-validation (Gate 1 pending) Last updated: 2026-02-18</p>"},{"location":"ARCHITECTURE/#problem","title":"Problem","text":"<p>AI agents are easy to run and hard to govern. Every team builds agents in their own stack \u2014 Python, Ruby, Go, TypeScript, custom frameworks. There is no standard way to answer three questions that every security team asks before approving deployment:</p> <ol> <li>What can this agent access? (least-privilege)</li> <li>What did this agent do? (audit trail)</li> <li>Who authorized it? (accountability)</li> </ol> <p>Today's answers are \"everything,\" \"we don't know,\" and \"nobody.\" Switchboard fixes this without requiring teams to rewrite their agents or adopt a new runtime.</p>"},{"location":"ARCHITECTURE/#core-principle","title":"Core Principle","text":"<p>Switchboard manages the box, not the code inside it.</p> <p>Like Kubernetes doesn't care if your service is written in Go, Java, or Python \u2014 it manages the container \u2014 Switchboard doesn't care how your agent is built. It manages the boundary: what the agent can access, what events it emits, and what policy governs it.</p> <p>The interface between Switchboard and any agent is a contract at the infrastructure level, not a language-specific SDK or schema standard.</p>"},{"location":"ARCHITECTURE/#the-switchboard-protocol","title":"The Switchboard Protocol","text":"<p>Switchboard defines a minimal contract between any agent and the Switchboard control plane. The contract has three parts:</p>"},{"location":"ARCHITECTURE/#1-policy-in-switchboard-agent","title":"1. Policy In (Switchboard \u2192 Agent)","text":"<p>Switchboard writes a policy file that the agent's runtime reads. The format adapts to the runtime \u2014 JSON, YAML, TOML, environment variables. The content is the same:</p> <pre><code># Example: policy.yaml (written by Switchboard sidecar)\nagent_id: warehouse-monitor\ntier: L2\nallowed_actions:\n  - read_inventory\n  - update_stock_level\n  - send_alert\ndenied_actions:\n  - delete_records\n  - access_credentials\nrate_limit:\n  external_api_calls_per_minute: 10\nchannels:\n  - inventory-alerts\n  - warehouse-ops\n</code></pre> <p>The agent reads this however its runtime prefers. A Python agent reads YAML. A Ruby agent reads JSON. A Go binary reads env vars. Switchboard doesn't care.</p>"},{"location":"ARCHITECTURE/#2-events-out-agent-switchboard","title":"2. Events Out (Agent \u2192 Switchboard)","text":"<p>The agent emits structured events to a known HTTP endpoint. Five fields:</p> <pre><code>{\n  \"agent_id\": \"warehouse-monitor\",\n  \"timestamp\": \"2026-02-18T14:32:01Z\",\n  \"action\": \"update_stock_level\",\n  \"target\": \"inventory.sku.A1234\",\n  \"result\": \"success\"\n}\n</code></pre> <p>Any language can do this in three lines of code. This is the audit trail.</p>"},{"location":"ARCHITECTURE/#3-enforcement-layer-infrastructure","title":"3. Enforcement Layer (Infrastructure)","text":"<p>Hard security boundaries that don't depend on agent cooperation:</p> <ul> <li>Container mounts \u2014 An L0 agent has no write mounts. Period.</li> <li>Network policies \u2014 An L1 agent can reach Switchboard and nothing else.</li> <li>Credential injection \u2014 Secrets live in Switchboard, not in agent containers.</li> <li>Resource limits \u2014 CPU, memory, and API rate caps at the container level.</li> </ul> <p>This layer works regardless of what the agent does internally. A compromised agent is trapped in its box.</p>"},{"location":"ARCHITECTURE/#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                 Control Plane                     \u2502\n\u2502    (Fleet dashboard, policy editor, audit log)    \u2502\n\u2502              [Rails / Web UI]                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                     \u2502 REST API\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   Switchboard                          \u2502\n\u2502            (Protocol endpoint)                    \u2502\n\u2502  \u2022 Ingests events from any agent                  \u2502\n\u2502  \u2022 Distributes policy to agent sidecars           \u2502\n\u2502  \u2022 Enforces rate limits and access control         \u2502\n\u2502  \u2022 Stores audit trail                             \u2502\n\u2514\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n   \u2502          \u2502          \u2502          \u2502\n\u250c\u2500\u2500\u25bc\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u25bc\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u25bc\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u25bc\u2500\u2500\u2510\n\u2502Scar \u2502  \u2502Scar  \u2502  \u2502Scar  \u2502  \u2502Scar  \u2502\n\u2502     \u2502  \u2502      \u2502  \u2502      \u2502  \u2502      \u2502\n\u2502Agent\u2502  \u2502Agent \u2502  \u2502Agent \u2502  \u2502Agent \u2502\n\u2502(Py) \u2502  \u2502(Ruby)\u2502  \u2502(Go)  \u2502  \u2502(any) \u2502\n\u2502     \u2502  \u2502      \u2502  \u2502      \u2502  \u2502      \u2502\n\u2502 L0  \u2502  \u2502 L1   \u2502  \u2502 L2   \u2502  \u2502 L3   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2518\nDocker    Docker    Docker    Docker\n</code></pre> <p>Each agent runs with a sidecar \u2014 a thin process that handles the Switchboard protocol on the agent's behalf. The sidecar: - Pulls policy from Switchboard and writes it in the format the agent expects - Forwards the agent's event output to Switchboard - Reports health status (heartbeat)</p> <p>The sidecar is ~50 lines of code in any language. Pre-built sidecars ship for Python, Ruby, and Go. Writing one for a new language takes a day.</p>"},{"location":"ARCHITECTURE/#autonomy-tiers-l0l3","title":"Autonomy Tiers (L0\u2013L3)","text":"Tier Label What the Agent Can Do Enforcement L0 Observer Read-only, no network, no writes Container has no write mounts or network access L1 Assistant Read data via Switchboard Switchboard enforces read-only routing L2 Operator Read/write within scope Human-in-the-loop gate on write actions L3 Autonomous Full action within policy boundary Policy-bounded, audit-logged <p>Tiers are enforced at the container and network level \u2014 not by prompts. An L0 agent physically cannot write to the filesystem because its Docker container has no write mounts. The model's intentions are irrelevant.</p>"},{"location":"ARCHITECTURE/#how-to-add-a-new-agent","title":"How to Add a New Agent","text":"<p>Regardless of what runtime or language the agent uses:</p> <ol> <li>Deploy with sidecar \u2014 Run your agent container alongside the Switchboard sidecar. The sidecar connects to Switchboard automatically.</li> <li>Set tier \u2014 Choose L0\u2013L3 from the control plane UI or API. Container mounts and network policy are configured accordingly.</li> <li>Emit events \u2014 Have your agent POST structured events to the sidecar's local endpoint. Five fields: agent_id, timestamp, action, target, result.</li> <li>Read policy \u2014 Your agent reads its policy from a local file the sidecar maintains. Format is whatever your runtime prefers.</li> </ol> <p>That's it. No framework to adopt, no schema to conform to, no language requirement.</p>"},{"location":"ARCHITECTURE/#threat-model","title":"Threat Model","text":"Vector Containment Prompt injection Compromised model is trapped in its container. An L0 agent that gets injected still has no write mounts and no network. Damage ceiling is zero. Credential exfiltration Secrets live in Switchboard, not in agent containers. Agents receive processed data only. No agent can read another agent's environment. Lateral movement No direct agent-to-agent communication. All messages route through Switchboard. A compromised agent cannot discover or reach other agents. Rogue sidecar The sidecar runs as a separate process with its own auth token. Even if an agent compromises its sidecar, container-level enforcement (mounts, network) still holds."},{"location":"ARCHITECTURE/#what-this-is-not","title":"What This Is Not","text":"<p>Switchboard is not a model safety tool. It does not evaluate prompt quality, detect hallucinations, or filter model outputs. It enforces infrastructure-level access control \u2014 what an agent can do, regardless of what the model wants to do.</p> <p>Switchboard is not an agent framework. It does not prescribe how agents are built, what language they use, or what schema they prefer. It manages the boundary around agents that already exist.</p>"},{"location":"ARCHITECTURE/#reference-implementation","title":"Reference Implementation","text":"<p>The <code>switchboard/</code> directory contains the first Switchboard implementation (FastAPI/Python). The <code>agents/</code> directory contains working agent configurations using OpenClaw as the runtime. This is the prototype that proves the architecture \u2014 not the only way to deploy.</p>"},{"location":"DESIGN/","title":"DESIGN.md \u2014 Switchboard Design System","text":"<p>Diataxis category: Reference Source: <code>docs/shared.css</code></p> <p>A portable, token-based dark-theme design system. No build tools required \u2014 link one CSS file and go.</p>"},{"location":"DESIGN/#quick-start","title":"Quick Start","text":"<pre><code>&lt;link rel=\"stylesheet\" href=\"/docs/shared.css\"&gt;\n&lt;body&gt;\n  &lt;div class=\"container\"&gt;Your content here&lt;/div&gt;\n&lt;/body&gt;\n</code></pre> <p>Dark theme, centered layout, system font stack \u2014 all from one file.</p>"},{"location":"DESIGN/#design-tokens","title":"Design Tokens","text":""},{"location":"DESIGN/#color-palette","title":"Color Palette","text":"Token Value Use <code>--bg-void</code> <code>#0a0a0c</code> Page background <code>--bg-obsidian</code> <code>#121215</code> Card backgrounds <code>--bg-charcoal</code> <code>#1a1a1f</code> Elevated surfaces <code>--bg-steel</code> <code>#2a2a32</code> Borders <code>--text-primary</code> <code>#f5f5f7</code> Body text (15:1 contrast) <code>--text-secondary</code> <code>#a8a8b0</code> Labels (7:1 contrast) <code>--accent</code> <code>#d4a24e</code> Gold \u2014 status/ok <code>--accent-blue</code> <code>#6b8cba</code> Links, active states <code>--status-ok</code> <code>#4ec9a0</code> Healthy/normal <code>--status-warn</code> <code>#c48a3a</code> Elevated/warning <code>--status-error</code> <code>#b0614e</code> Degraded/error"},{"location":"DESIGN/#typography","title":"Typography","text":"<ul> <li>UI: Outfit (sans-serif)</li> <li>Metrics/Code: Space Mono (monospace)</li> </ul>"},{"location":"DESIGN/#governance-tokens","title":"Governance Tokens","text":"<p>Tier and integrity colors for the fleet dashboard:</p> Token Maps To <code>--tier-l0</code> <code>--accent-blue</code> <code>--tier-l1</code> <code>--status-ok</code> <code>--tier-l2</code> <code>--status-warn</code> <code>--tier-l3</code> <code>--status-error</code> <code>--integrity-normal</code> <code>--status-ok</code> <code>--integrity-elevated</code> <code>--status-warn</code> <code>--integrity-degraded</code> <code>--status-error</code>"},{"location":"DESIGN/#components","title":"Components","text":""},{"location":"DESIGN/#nav","title":"Nav","text":"<p>Sticky top navigation with brand, links, and status indicator.</p> <pre><code>&lt;nav class=\"nav\"&gt;\n  &lt;div class=\"nav__inner\"&gt;\n    &lt;a href=\"/dashboard\" class=\"nav__brand\"&gt;switchboard &lt;span&gt;/ fleet&lt;/span&gt;&lt;/a&gt;\n    &lt;a href=\"/dashboard\" class=\"active\"&gt;Dashboard&lt;/a&gt;\n    &lt;div class=\"nav__status\"&gt;\n      &lt;div class=\"nav__dot\"&gt;&lt;/div&gt;\n      &lt;span&gt;3 agents&lt;/span&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/nav&gt;\n</code></pre>"},{"location":"DESIGN/#agent-cards","title":"Agent Cards","text":"<p>Fleet grid with tier color, status dot, integrity badge.</p> <pre><code>&lt;div class=\"fleet-grid\"&gt;\n  &lt;div class=\"agent-card\" style=\"--card-tier-color: #00ff88\"&gt;\n    &lt;div class=\"agent-card__head\"&gt;\n      &lt;div class=\"agent-card__dot agent-card__dot--online\"&gt;&lt;/div&gt;\n      &lt;div class=\"agent-card__name\"&gt;My Agent&lt;/div&gt;\n      &lt;div class=\"agent-card__tier\"&gt;L1 Assistant&lt;/div&gt;\n    &lt;/div&gt;\n    &lt;div class=\"agent-card__meta\"&gt;...&lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>"},{"location":"DESIGN/#stat-row-detail-panel-tier-selector-permission-grid","title":"Stat Row, Detail Panel, Tier Selector, Permission Grid","text":"<p>See <code>dashboard/index.html</code> for live usage of all components.</p>"},{"location":"DESIGN/#accessibility","title":"Accessibility","text":"<ul> <li>Skip links (<code>&lt;a class=\"skip-link\"&gt;</code>)</li> <li>Screen reader utility (<code>.sr-only</code>)</li> <li>Focus-visible rings on interactive elements</li> <li><code>prefers-reduced-motion</code> respected</li> <li>ARIA landmarks, labels, and live regions</li> <li>WCAG AA contrast ratios (primary 15:1, secondary 7:1)</li> </ul>"},{"location":"DESIGN/#philosophy","title":"Philosophy","text":"<p>\"Refined, not neon.\" Desaturated teal, gold, and blue. No glow effects. Instrument-panel aesthetic \u2014 professional and readable.</p>"},{"location":"PROTOCOL/","title":"Switchboard Protocol Specification","text":"<p>Version: 0.1.0 Status: Draft Last updated: 2026-02-19 Type: Reference</p> <p>Switchboard is the governance protocol that connects any AI agent to the Switchboard control plane. It defines a minimal contract: policy in, events out. Any agent in any language can integrate by implementing this contract.</p>"},{"location":"PROTOCOL/#overview","title":"Overview","text":"<p>The Switchboard protocol has three directions and one enforcement layer:</p> Direction What Transport Who Implements Policy In Switchboard tells the agent what it's allowed to do Local file or env vars Sidecar (provided) Events Out Agent tells Switchboard what it did HTTP POST to local sidecar Agent developer (~3 lines) Telemetry Out Sidecar/sensor emits integrity signals and claims HTTP POST to Switchboard Sidecar (built-in) Enforcement Infrastructure limits that don't require agent cooperation Container config Switchboard (automatic) <p>The sidecar handles all Switchboard communication. The agent only needs to: (1) read a local policy file, and (2) POST events to <code>localhost</code>.</p>"},{"location":"PROTOCOL/#events-agent-switchboard","title":"Events (Agent \u2192 Switchboard)","text":""},{"location":"PROTOCOL/#event-schema","title":"Event Schema","text":"<p>Every event is a JSON object with five required fields:</p> <pre><code>{\n  \"agent_id\": \"string\",\n  \"timestamp\": \"ISO 8601\",\n  \"action\": \"string\",\n  \"target\": \"string\",\n  \"result\": \"success | failure | pending | denied\"\n}\n</code></pre> Field Type Description <code>agent_id</code> string Unique identifier for this agent instance <code>timestamp</code> string ISO 8601 timestamp of when the action occurred <code>action</code> string What the agent did (e.g., <code>read_file</code>, <code>api_call</code>, <code>send_message</code>) <code>target</code> string What the action operated on (e.g., <code>inventory.csv</code>, <code>slack.#general</code>) <code>result</code> enum Outcome: <code>success</code>, <code>failure</code>, <code>pending</code> (awaiting HITL), <code>denied</code> (policy blocked) <p>Optional fields:</p> Field Type Description <code>detail</code> string Human-readable description of what happened <code>duration_ms</code> integer How long the action took <code>tier</code> string Agent's tier at time of action (L0\u2013L3) <code>request_id</code> string Correlation ID for multi-step operations"},{"location":"PROTOCOL/#event-types","title":"Event Types","text":"<p>Agents emit events by POSTing to the sidecar at <code>http://localhost:9100/events</code>.</p> <p>Action taken \u2014 the primary event. Emitted after every meaningful action:</p> <pre><code>{\n  \"agent_id\": \"warehouse-monitor\",\n  \"timestamp\": \"2026-02-18T14:32:01Z\",\n  \"action\": \"update_stock_level\",\n  \"target\": \"inventory.sku.A1234\",\n  \"result\": \"success\"\n}\n</code></pre> <p>Permission request \u2014 when an L2 agent needs HITL approval:</p> <pre><code>{\n  \"agent_id\": \"warehouse-monitor\",\n  \"timestamp\": \"2026-02-18T14:32:05Z\",\n  \"action\": \"request_permission\",\n  \"target\": \"delete_expired_records\",\n  \"result\": \"pending\",\n  \"detail\": \"47 records older than 90 days\"\n}\n</code></pre> <p>Error \u2014 when something goes wrong:</p> <pre><code>{\n  \"agent_id\": \"warehouse-monitor\",\n  \"timestamp\": \"2026-02-18T14:32:10Z\",\n  \"action\": \"api_call\",\n  \"target\": \"https://supplier.example.com/api/reorder\",\n  \"result\": \"failure\",\n  \"detail\": \"Connection refused\"\n}\n</code></pre>"},{"location":"PROTOCOL/#heartbeat","title":"Heartbeat","text":"<p>The sidecar handles heartbeats automatically. No agent implementation required. The sidecar POSTs to Switchboard every 30 seconds:</p> <pre><code>{\n  \"agent_id\": \"warehouse-monitor\",\n  \"timestamp\": \"2026-02-18T14:32:30Z\",\n  \"action\": \"heartbeat\",\n  \"target\": \"self\",\n  \"result\": \"success\"\n}\n</code></pre>"},{"location":"PROTOCOL/#telemetry-signals","title":"Telemetry Signals","text":"<p>Why telemetry matters. Agent governance without attestation is guesswork. A policy can declare that an agent runs Anthropic's Claude on <code>us-west-2</code>, but without measurement, that claim is unverifiable. Telemetry closes this gap by applying a physics-based principle: latency is unfakeable. A keystroke traveling from a local machine takes 20-50ms. The same keystroke routed through a trans-Pacific VPN or remote desktop takes 110ms+. Network RTT, jitter, and HID timing create a fingerprint that no proxy can hide because the speed of light through fiber adds ~5 microseconds per kilometer. Combined with runtime claims (provider, model, region) and remote-session detection, Switchboard can score the integrity of every agent in the fleet \u2014 not by trusting what agents say, but by measuring what the infrastructure reveals.</p> <p>Sidecars may POST integrity telemetry directly to Switchboard. This is additive and runtime-agnostic.</p> <pre><code>{\n  \"agent_id\": \"warehouse-monitor\",\n  \"timestamp\": \"2026-02-18T14:33:00Z\",\n  \"probe_source\": \"sidecar\",\n  \"telemetry_mode\": \"sidecar_only\",\n  \"network_rtt_ms\": 12.4,\n  \"network_jitter_ms\": 1.8,\n  \"is_remote_session\": false,\n  \"observed_provider\": \"anthropic\",\n  \"observed_model\": \"claude-sonnet-4-5\",\n  \"observed_region\": \"us-west-2\"\n}\n</code></pre> <p>Optional sensor fields can be included when available: - <code>sensor_hid_rtt_ms</code> - <code>sensor_dwell_ms</code> - <code>sensor_os_jitter_ms</code></p> <p>Switchboard evaluates telemetry against policy integrity constraints and exposes: - <code>integrity_status</code> (<code>normal</code> | <code>elevated</code> | <code>degraded</code> | <code>unknown</code>) - <code>integrity_score</code> (0\u2013100) - <code>integrity_reasons</code> (human-readable mismatch or threshold reasons)</p> <p>For dashboard UX, Switchboard also exposes a public telemetry timeline endpoint with: - recent per-sample integrity evaluations - rolling scorecards (latest/mean/p50/p95/min/max) - high-latency and remote-session sample counts</p>"},{"location":"PROTOCOL/#policy-switchboard-agent","title":"Policy (Switchboard \u2192 Agent)","text":"<p>The sidecar pulls policy from Switchboard and writes it as a local file. The agent reads this file in whatever format its runtime prefers.</p>"},{"location":"PROTOCOL/#policy-schema","title":"Policy Schema","text":"<pre><code>agent_id: warehouse-monitor\ntier: L2\nversion: 3                        # Increments on policy change\n\nallowed_actions:\n  - read_inventory\n  - update_stock_level\n  - send_alert\n\ndenied_actions:\n  - delete_records\n  - access_credentials\n  - modify_network\n\nrate_limits:\n  events_per_minute: 60\n  external_api_calls_per_minute: 10\n\nchannels:\n  - inventory-alerts\n  - warehouse-ops\n\ncredentials:                       # Injected by sidecar, not stored in agent container\n  SUPPLIER_API_KEY: \"injected-at-runtime\"\n</code></pre>"},{"location":"PROTOCOL/#policy-formats","title":"Policy Formats","text":"<p>The sidecar writes policy in the format configured for the agent:</p> Format File Use Case YAML <code>/switchboard/policy.yaml</code> Python, Ruby agents JSON <code>/switchboard/policy.json</code> Node.js, Go agents ENV <code>/switchboard/.env</code> Simple agents, shell scripts TOML <code>/switchboard/policy.toml</code> Rust agents <p>The sidecar watches for policy updates from Switchboard and rewrites the local file. Agents can either re-read on each action or watch the file for changes.</p>"},{"location":"PROTOCOL/#policy-delivery","title":"Policy Delivery","text":"<p>The sidecar polls Switchboard for policy updates:</p> <pre><code>GET /api/v1/agents/{agent_id}/policy\nAuthorization: Bearer {sidecar_token}\n</code></pre> <p>Response:</p> <pre><code>{\n  \"agent_id\": \"warehouse-monitor\",\n  \"tier\": \"L2\",\n  \"version\": 3,\n  \"allowed_actions\": [\"read_inventory\", \"update_stock_level\", \"send_alert\"],\n  \"denied_actions\": [\"delete_records\", \"access_credentials\"],\n  \"rate_limits\": {\"events_per_minute\": 60, \"external_api_calls_per_minute\": 10},\n  \"channels\": [\"inventory-alerts\", \"warehouse-ops\"]\n}\n</code></pre>"},{"location":"PROTOCOL/#integrity-policy-presets","title":"Integrity Policy Presets","text":"<p>Switchboard ships built-in integrity presets to reduce manual policy edits:</p> <ul> <li><code>standard</code> (recommended) - balanced thresholds for day-to-day operations</li> <li><code>strict</code> - tighter latency thresholds for sensitive workloads</li> <li><code>relaxed</code> - higher thresholds for unstable/distributed networks</li> </ul> <p>Presets can be listed and applied via API, with optional claim pinning (use current observed provider/model/region as expected values).</p>"},{"location":"PROTOCOL/#sidecar","title":"Sidecar","text":"<p>The sidecar is a lightweight process that runs alongside the agent container. It handles all Switchboard protocol communication so the agent doesn't have to.</p>"},{"location":"PROTOCOL/#what-the-sidecar-does","title":"What the Sidecar Does","text":"<ol> <li>Registers the agent with Switchboard on startup</li> <li>Pulls policy from Switchboard and writes it locally</li> <li>Accepts events from the agent on <code>localhost:9100</code></li> <li>Forwards events to Switchboard with authentication</li> <li>Sends heartbeats every 30 seconds</li> <li>Watches for policy changes and updates the local file</li> </ol>"},{"location":"PROTOCOL/#sidecar-configuration","title":"Sidecar Configuration","text":"<pre><code># switchboard-sidecar.yaml\nswitchboard_url: https://switchboard.example.com\nagent_id: warehouse-monitor\nsidecar_token: swb_sk_...\npolicy_format: yaml              # yaml | json | env | toml\npolicy_path: /switchboard/policy.yaml\nevent_listen_port: 9100\nheartbeat_interval_seconds: 30\n</code></pre>"},{"location":"PROTOCOL/#deployment","title":"Deployment","text":"<p>The sidecar runs as a second container in the same pod (Kubernetes) or service (Docker Compose):</p> <pre><code># docker-compose.yaml\nservices:\n  warehouse-monitor:\n    image: my-org/warehouse-agent:latest\n    volumes:\n      - switchboard-policy:/switchboard:ro    # Read-only policy mount\n    # No direct network access to Switchboard \u2014 goes through sidecar\n\n  warehouse-monitor-sidecar:\n    image: switchboard/sidecar:latest\n    environment:\n      SWITCHBOARD_URL: https://switchboard.example.com\n      AGENT_ID: warehouse-monitor\n      SIDECAR_TOKEN: ${SIDECAR_TOKEN}\n      POLICY_FORMAT: yaml\n    volumes:\n      - switchboard-policy:/switchboard       # Writes policy for agent to read\n    ports:\n      - \"9100\"                          # Internal only \u2014 agent posts events here\n\nvolumes:\n  switchboard-policy:\n</code></pre>"},{"location":"PROTOCOL/#integration-examples","title":"Integration Examples","text":""},{"location":"PROTOCOL/#python-3-lines","title":"Python (3 lines)","text":"<pre><code>import httpx\n\ndef report(action: str, target: str, result: str = \"success\"):\n    httpx.post(\"http://localhost:9100/events\", json={\n        \"agent_id\": AGENT_ID,\n        \"timestamp\": datetime.utcnow().isoformat() + \"Z\",\n        \"action\": action,\n        \"target\": target,\n        \"result\": result,\n    })\n</code></pre>"},{"location":"PROTOCOL/#ruby-3-lines","title":"Ruby (3 lines)","text":"<pre><code>require 'net/http'\nrequire 'json'\n\ndef report(action, target, result = \"success\")\n  uri = URI(\"http://localhost:9100/events\")\n  Net::HTTP.post(uri, {\n    agent_id: AGENT_ID,\n    timestamp: Time.now.utc.iso8601,\n    action: action,\n    target: target,\n    result: result\n  }.to_json, \"Content-Type\" =&gt; \"application/json\")\nend\n</code></pre>"},{"location":"PROTOCOL/#go-3-lines-equivalent","title":"Go (3 lines equivalent)","text":"<pre><code>func report(action, target, result string) error {\n    event := map[string]string{\n        \"agent_id\":  agentID,\n        \"timestamp\": time.Now().UTC().Format(time.RFC3339),\n        \"action\":    action,\n        \"target\":    target,\n        \"result\":    result,\n    }\n    body, _ := json.Marshal(event)\n    _, err := http.Post(\"http://localhost:9100/events\", \"application/json\", bytes.NewReader(body))\n    return err\n}\n</code></pre>"},{"location":"PROTOCOL/#curl-for-testing","title":"curl (for testing)","text":"<pre><code>curl -X POST http://localhost:9100/events \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"agent_id\": \"test-agent\",\n    \"timestamp\": \"'$(date -u +%Y-%m-%dT%H:%M:%SZ)'\",\n    \"action\": \"test_action\",\n    \"target\": \"test_target\",\n    \"result\": \"success\"\n  }'\n</code></pre>"},{"location":"PROTOCOL/#switchboard-api-control-plane-switchboard","title":"Switchboard API (Control Plane \u2194 Switchboard)","text":"<p>These endpoints are used by the control plane UI and admin tools, not by agents directly.</p>"},{"location":"PROTOCOL/#agent-management","title":"Agent Management","text":"<pre><code>POST   /api/v1/agents                    # Register new agent\nGET    /api/v1/agents                    # List all agents\nGET    /api/v1/agents/{agent_id}         # Get agent status\nPUT    /api/v1/agents/{agent_id}/policy  # Update agent policy\nGET    /api/v1/policy/presets            # List built-in integrity presets\nPOST   /api/v1/agents/{agent_id}/policy/preset  # Apply preset to one agent\nPOST   /api/v1/fleet/policy/preset       # Apply preset to some/all agents\nDELETE /api/v1/agents/{agent_id}         # Deregister agent\n</code></pre>"},{"location":"PROTOCOL/#event-ingestion","title":"Event Ingestion","text":"<pre><code>POST   /api/v1/events                    # Receive events (from sidecars)\nPOST   /api/v1/telemetry                 # Receive telemetry signals (from sidecars/sensors)\n</code></pre>"},{"location":"PROTOCOL/#audit-log","title":"Audit Log","text":"<pre><code>GET    /api/v1/events                    # Query audit log\nGET    /api/v1/events?agent_id=X         # Filter by agent\nGET    /api/v1/events?action=Y           # Filter by action type\nGET    /api/v1/events?since=ISO8601      # Filter by time\n</code></pre>"},{"location":"PROTOCOL/#fleet-status","title":"Fleet Status","text":"<pre><code>GET    /api/v1/fleet/status              # All agents with health, tier, last event\nGET    /api/v1/fleet/health              # Aggregate health (up/down/degraded counts)\nGET    /api/v1/fleet/telemetry           # Public telemetry timeline + scorecards\nGET    /api/v1/telemetry                 # Query full telemetry history (admin)\n</code></pre>"},{"location":"PROTOCOL/#security","title":"Security","text":""},{"location":"PROTOCOL/#authentication","title":"Authentication","text":"<ul> <li>Sidecar \u2192 Switchboard: Bearer token (<code>swb_sk_...</code>) issued during agent registration</li> <li>Control Plane \u2192 Switchboard: API key with admin scope</li> <li>Agent \u2192 Sidecar: No auth required (localhost only, not exposed externally)</li> </ul>"},{"location":"PROTOCOL/#token-scopes","title":"Token Scopes","text":"Scope Can Do <code>agent:events</code> Post events, read own policy <code>agent:policy</code> Read/write policy for assigned agents <code>fleet:read</code> Read fleet status, query audit log <code>fleet:admin</code> Register/deregister agents, modify any policy"},{"location":"PROTOCOL/#versioning","title":"Versioning","text":"<p>The Switchboard protocol uses semantic versioning. Breaking changes increment the major version and are announced with a deprecation period.</p> <ul> <li>Current: <code>v1</code> (draft)</li> <li>Endpoint prefix: <code>/api/v1/</code></li> <li>Policy schema includes a <code>version</code> field for change detection</li> </ul>"},{"location":"api-reference/","title":"API Reference","text":"<p>Switchboard v1 governance protocol endpoints. All routes are prefixed with <code>/api/v1</code>.</p>"},{"location":"api-reference/#authentication","title":"Authentication","text":""},{"location":"api-reference/#admin-key-x-switchboard-key-header","title":"Admin Key (<code>X-Switchboard-Key</code> header)","text":"<p>Required for agent management, policy updates, and telemetry queries. Set via <code>SWITCHBOARD_API_KEY</code> environment variable. When unset, Switchboard runs in dev mode (no auth required).</p>"},{"location":"api-reference/#sidecar-token-authorization-bearer-header","title":"Sidecar Token (<code>Authorization: Bearer</code> header)","text":"<p>Required for event ingestion, telemetry reporting, and policy fetching. Tokens are issued during agent registration and start with <code>swb_sk_</code>.</p>"},{"location":"api-reference/#agent-management","title":"Agent Management","text":""},{"location":"api-reference/#register-agent","title":"Register Agent","text":"<pre><code>POST /api/v1/agents\n</code></pre> <p>Auth: Admin key</p> <p>Body:</p> <pre><code>{\n  \"agent_id\": \"my-agent\",\n  \"display_name\": \"My Agent\",\n  \"tier\": \"L1\",\n  \"allowed_actions\": [\"file_read\"],\n  \"denied_actions\": [\"delete_records\"],\n  \"channels\": [\"ops\"]\n}\n</code></pre> <p>Response:</p> <pre><code>{\n  \"ok\": true,\n  \"existing\": false,\n  \"agent_id\": \"my-agent\",\n  \"token\": \"swb_sk_...\",\n  \"policy\": { ... }\n}\n</code></pre> <p>Re-registering an existing agent returns the same token (<code>\"existing\": true</code>).</p>"},{"location":"api-reference/#list-agents","title":"List Agents","text":"<pre><code>GET /api/v1/agents\n</code></pre> <p>Auth: Admin key</p>"},{"location":"api-reference/#get-agent","title":"Get Agent","text":"<pre><code>GET /api/v1/agents/{agent_id}\n</code></pre> <p>Auth: Admin key. Returns 404 for unknown agents.</p>"},{"location":"api-reference/#deregister-agent","title":"Deregister Agent","text":"<pre><code>DELETE /api/v1/agents/{agent_id}\n</code></pre> <p>Auth: Admin key. Returns 404 for unknown agents.</p>"},{"location":"api-reference/#policy","title":"Policy","text":""},{"location":"api-reference/#get-agent-policy-sidecar","title":"Get Agent Policy (Sidecar)","text":"<pre><code>GET /api/v1/agents/{agent_id}/policy\n</code></pre> <p>Auth: Sidecar bearer token. Returns 403 if token doesn't match agent.</p>"},{"location":"api-reference/#update-policy","title":"Update Policy","text":"<pre><code>PUT /api/v1/agents/{agent_id}/policy\n</code></pre> <p>Auth: Admin key</p> <p>Body (all fields optional):</p> <pre><code>{\n  \"tier\": \"L2\",\n  \"allowed_actions\": [\"file_read\", \"file_write\"],\n  \"denied_actions\": [\"delete_records\"],\n  \"integrity\": {\n    \"max_network_rtt_ms\": 120.0,\n    \"max_network_jitter_ms\": 30.0,\n    \"expected_providers\": [\"anthropic\"],\n    \"allow_remote_session\": false\n  }\n}\n</code></pre> <p>Each update increments the policy version.</p>"},{"location":"api-reference/#list-policy-presets","title":"List Policy Presets","text":"<pre><code>GET /api/v1/policy/presets\n</code></pre> <p>Auth: None (public). Returns standard, strict, and relaxed presets with their integrity thresholds.</p>"},{"location":"api-reference/#apply-preset-to-agent","title":"Apply Preset to Agent","text":"<pre><code>POST /api/v1/agents/{agent_id}/policy/preset\n</code></pre> <p>Auth: Admin key</p> <p>Body:</p> <pre><code>{\n  \"preset\": \"strict\",\n  \"pin_observed_claims\": true\n}\n</code></pre> <p>When <code>pin_observed_claims</code> is true, the agent's currently observed provider/model/region become the expected values in policy.</p>"},{"location":"api-reference/#apply-preset-to-fleet","title":"Apply Preset to Fleet","text":"<pre><code>POST /api/v1/fleet/policy/preset\n</code></pre> <p>Auth: Admin key</p> <p>Body:</p> <pre><code>{\n  \"preset\": \"standard\",\n  \"agent_ids\": [\"agent-1\", \"agent-2\"],\n  \"pin_observed_claims\": false\n}\n</code></pre> <p>Empty <code>agent_ids</code> applies to all registered agents.</p>"},{"location":"api-reference/#events","title":"Events","text":""},{"location":"api-reference/#ingest-event-sidecar","title":"Ingest Event (Sidecar)","text":"<pre><code>POST /api/v1/events\n</code></pre> <p>Auth: Sidecar bearer token. Token must match the event's <code>agent_id</code>.</p> <p>Body:</p> <pre><code>{\n  \"agent_id\": \"my-agent\",\n  \"action\": \"file_read\",\n  \"target\": \"/data/report.csv\",\n  \"result\": \"success\",\n  \"detail\": \"Read 1024 bytes\",\n  \"duration_ms\": 12\n}\n</code></pre> <p>Heartbeat events (<code>\"action\": \"heartbeat\"</code>) update the agent's last heartbeat timestamp without counting as a regular event.</p>"},{"location":"api-reference/#query-events-audit-log","title":"Query Events (Audit Log)","text":"<pre><code>GET /api/v1/events?agent_id=...&amp;action=...&amp;since=...&amp;limit=100\n</code></pre> <p>Auth: None (public). Returns events most-recent-first.</p> Parameter Type Description <code>agent_id</code> string Filter by agent <code>action</code> string Filter by action type <code>since</code> ISO 8601 Only events after this timestamp <code>limit</code> int (1-1000) Max results (default: 100)"},{"location":"api-reference/#telemetry","title":"Telemetry","text":""},{"location":"api-reference/#ingest-telemetry-sidecar","title":"Ingest Telemetry (Sidecar)","text":"<pre><code>POST /api/v1/telemetry\n</code></pre> <p>Auth: Sidecar bearer token</p> <p>Body:</p> <pre><code>{\n  \"agent_id\": \"my-agent\",\n  \"probe_source\": \"sidecar\",\n  \"network_rtt_ms\": 2.5,\n  \"network_jitter_ms\": 0.8,\n  \"is_remote_session\": false,\n  \"observed_provider\": \"anthropic\",\n  \"observed_model\": \"claude-3\",\n  \"observed_region\": \"us-east-1\"\n}\n</code></pre> <p>Ingesting telemetry triggers an integrity assessment. The response includes the updated score and status.</p>"},{"location":"api-reference/#query-telemetry","title":"Query Telemetry","text":"<pre><code>GET /api/v1/telemetry?agent_id=...&amp;since=...&amp;limit=100\n</code></pre> <p>Auth: Admin key</p>"},{"location":"api-reference/#fleet-status","title":"Fleet Status","text":""},{"location":"api-reference/#fleet-status_1","title":"Fleet Status","text":"<pre><code>GET /api/v1/fleet/status\n</code></pre> <p>Auth: None (public). Returns all agents with health, tier, integrity, and last activity.</p>"},{"location":"api-reference/#fleet-health","title":"Fleet Health","text":"<pre><code>GET /api/v1/fleet/health\n</code></pre> <p>Auth: None (public). Returns aggregate counts: active, inactive, degraded, and integrity status distribution.</p>"},{"location":"api-reference/#fleet-telemetry","title":"Fleet Telemetry","text":"<pre><code>GET /api/v1/fleet/telemetry?agent_id=...&amp;since=...&amp;limit=200\n</code></pre> <p>Auth: None (public). Returns telemetry timeline with scorecards (min, max, p50, p95) for dashboard visualization.</p>"},{"location":"autonomy-tiers/","title":"Autonomy Tiers (L0-L3)","text":"<p>Switchboard governs agent capabilities through four autonomy tiers, enforced at the infrastructure level.</p>"},{"location":"autonomy-tiers/#tier-overview","title":"Tier Overview","text":"Tier Label What the Agent Can Do Enforcement L0 Observer Read-only, no network, no writes Container has no write mounts or network access L1 Assistant Read data via Switchboard Switchboard enforces read-only routing L2 Operator Read/write within scope Human-in-the-loop gate on write actions L3 Autonomous Full action within policy boundary Policy-bounded, audit-logged"},{"location":"autonomy-tiers/#key-principle","title":"Key Principle","text":"<p>Tiers are enforced at the container and network level \u2014 not by prompts. An L0 agent physically cannot write to the filesystem because its Docker container has no write mounts. The model's intentions are irrelevant.</p>"},{"location":"autonomy-tiers/#l0-observer","title":"L0 \u2014 Observer","text":"<p>The most restrictive tier. The agent can observe but cannot act.</p> <ul> <li>Filesystem: Read-only mounts only</li> <li>Network: No outbound access (except Switchboard via sidecar)</li> <li>Use cases: Monitoring, log analysis, read-only dashboards</li> <li>Risk ceiling: Zero. Even a fully compromised L0 agent cannot cause damage.</li> </ul>"},{"location":"autonomy-tiers/#l1-assistant","title":"L1 \u2014 Assistant","text":"<p>The agent can read data and respond to queries, but cannot modify state.</p> <ul> <li>Filesystem: Read-only mounts</li> <li>Network: Switchboard API only (via sidecar)</li> <li>Use cases: Q&amp;A bots, research assistants, data lookups</li> <li>Risk ceiling: Information disclosure only. No state changes possible.</li> </ul>"},{"location":"autonomy-tiers/#l2-operator","title":"L2 \u2014 Operator","text":"<p>The agent can read and write within a defined scope, with human approval on writes.</p> <ul> <li>Filesystem: Scoped read/write mounts</li> <li>Network: Allowed endpoints only (configured in policy)</li> <li>HITL gate: Write actions require human-in-the-loop approval</li> <li>Use cases: Code assistants, content editors, automated ops with approval</li> <li>Risk ceiling: Scoped to approved write targets. Human reviews every mutation.</li> </ul>"},{"location":"autonomy-tiers/#l3-autonomous","title":"L3 \u2014 Autonomous","text":"<p>Full action authority within the policy boundary. No human gate on individual actions.</p> <ul> <li>Filesystem: Full access within policy scope</li> <li>Network: All allowed endpoints</li> <li>Audit: Every action logged to Switchboard</li> <li>Use cases: CI/CD automation, autonomous ops, scheduled tasks</li> <li>Risk ceiling: Bounded by policy. Every action is auditable. Revocable at any time.</li> </ul>"},{"location":"autonomy-tiers/#setting-a-tier","title":"Setting a Tier","text":""},{"location":"autonomy-tiers/#via-api","title":"Via API","text":"<pre><code>curl -X PUT http://localhost:59237/api/v1/agents/my-agent/policy \\\n  -H \"Content-Type: application/json\" \\\n  -H \"X-Switchboard-Key: $SWITCHBOARD_API_KEY\" \\\n  -d '{\"tier\": \"L2\"}'\n</code></pre>"},{"location":"autonomy-tiers/#at-registration","title":"At Registration","text":"<pre><code>curl -X POST http://localhost:59237/api/v1/agents \\\n  -H \"Content-Type: application/json\" \\\n  -H \"X-Switchboard-Key: $SWITCHBOARD_API_KEY\" \\\n  -d '{\"agent_id\": \"my-agent\", \"tier\": \"L1\"}'\n</code></pre>"},{"location":"autonomy-tiers/#via-dashboard","title":"Via Dashboard","text":"<p>Open the dashboard, select an agent, and use the tier selector.</p>"},{"location":"autonomy-tiers/#tier-escalation","title":"Tier Escalation","text":"<p>Tiers can be changed at any time by an admin. The sidecar picks up the new policy on its next sync cycle (default: 30 seconds). There is no automatic tier escalation \u2014 an agent cannot promote itself.</p>"},{"location":"claude-contributor/","title":"AI Agent Rules (CLAUDE.md)","text":"<p>Rules for AI coding agents contributing to Switchboard. If you use Claude Code, Cursor, Copilot, or any AI assistant to write code for this repo, these are the guardrails.</p>"},{"location":"claude-contributor/#what-switchboard-is","title":"What Switchboard Is","text":"<p>Switchboard is a governance protocol for AI agent fleets. It manages the boundary around agents \u2014 not the agents themselves. Runtime-agnostic: any language, any framework.</p>"},{"location":"claude-contributor/#project-structure","title":"Project Structure","text":"<pre><code>switchboard/\n\u251c\u2500\u2500 switchboard/              # Python package\n\u2502   \u251c\u2500\u2500 app.py           # FastAPI app (~35 lines)\n\u2502   \u2514\u2500\u2500 v1/              # Governance protocol endpoints\n\u2502       \u251c\u2500\u2500 models.py    # Pydantic models\n\u2502       \u251c\u2500\u2500 routes.py    # API routes (17 endpoints)\n\u2502       \u2514\u2500\u2500 services.py  # Service layer (file-backed JSON)\n\u251c\u2500\u2500 sidecar/             # Reference sidecar (stdlib Python, zero deps)\n\u251c\u2500\u2500 dashboard/           # Fleet dashboard (single HTML file)\n\u251c\u2500\u2500 docs/                # Documentation (MkDocs \u2192 GitHub Pages)\n\u251c\u2500\u2500 examples/            # Integration examples\n\u2514\u2500\u2500 tests/               # pytest suite\n</code></pre>"},{"location":"claude-contributor/#commands","title":"Commands","text":"<pre><code># Development\npip install -e \".[dev]\"\nuvicorn switchboard.app:app --port 59237 --reload\n\n# Testing\npytest tests/ -v --tb=short\nruff check switchboard/ tests/\npython3 scripts/check_test_quality.py\n\n# Documentation\npip install mkdocs-material\nmkdocs serve  # preview at localhost:8000\nmkdocs build  # build static site\n</code></pre>"},{"location":"claude-contributor/#rules-for-ai-agents","title":"Rules for AI Agents","text":""},{"location":"claude-contributor/#do","title":"Do","text":"<ul> <li>Run <code>pytest</code> and <code>ruff check</code> before suggesting your changes are complete</li> <li>Use the shared test fixtures from <code>tests/conftest.py</code> (isolated storage, admin headers, registered agents)</li> <li>Keep the sidecar stdlib-only \u2014 no external dependencies</li> <li>Match the existing code style (the codebase is small, read it first)</li> </ul>"},{"location":"claude-contributor/#dont","title":"Don't","text":"<ul> <li>Don't add new dependencies without discussing in the PR</li> <li>Don't modify <code>docs/shared.css</code> without understanding the design system</li> <li>Don't skip the test quality guard \u2014 it runs in CI</li> <li>Don't add framework abstractions \u2014 Switchboard is intentionally simple</li> <li>Don't \"improve\" code you weren't asked to change</li> </ul>"},{"location":"claude-contributor/#port-map","title":"Port Map","text":"Port Service 59237 Switchboard API + Dashboard 9100 Sidecar event listener (per-agent, localhost only)"},{"location":"claude-contributor/#storage","title":"Storage","text":"<p>File-backed JSON in <code>data/v1/</code> (gitignored). Tests use <code>tmp_path</code> \u2014 never touch real storage.</p>"},{"location":"claude-contributor/#architecture-notes","title":"Architecture Notes","text":"<ul> <li>v1 endpoints have no external deps beyond FastAPI/Pydantic</li> <li>Sidecar is stdlib-only Python 3.11+</li> <li>Dashboard is a single HTML file with inline JS</li> <li>Design tokens in <code>docs/shared.css</code> (dark theme, WCAG AA)</li> </ul>"},{"location":"contributing/","title":"Contributor Guide","text":"<p>Switchboard is MIT-licensed and accepts contributions. This guide covers the development workflow and standards.</p>"},{"location":"contributing/#getting-started","title":"Getting Started","text":"<pre><code>git clone https://github.com/watthem/switchboard.git\ncd switchboard\npython -m venv .venv &amp;&amp; source .venv/bin/activate\npip install -e \".[dev]\"\n</code></pre>"},{"location":"contributing/#development-workflow","title":"Development Workflow","text":"<ol> <li>Create a branch from <code>main</code></li> <li>Make your changes</li> <li>Run tests: <code>pytest tests/ -v --tb=short</code></li> <li>Run lint: <code>ruff check switchboard/ tests/</code></li> <li>Run test quality guard: <code>python3 scripts/check_test_quality.py</code></li> <li>Open a pull request against <code>main</code></li> </ol>"},{"location":"contributing/#branch-strategy","title":"Branch Strategy","text":"Branch Purpose <code>main</code> Stable. Docs, specs, tested code. PRs merged here. <code>poc</code> Product owner's engineering work via Claude Code. May be rough. <code>dev</code> Engineering branch (future, post-Gate 1)."},{"location":"contributing/#testing-standards","title":"Testing Standards","text":"<ul> <li>All new endpoints need integration tests</li> <li>Business logic (integrity scoring, policy application) needs unit tests</li> <li>Tests must use the shared fixtures from <code>tests/conftest.py</code> for storage isolation</li> <li>The test quality guard enforces:<ul> <li>No tautological asserts (<code>assert True</code>, <code>assert x == x</code>)</li> <li>Every test function has at least one assert</li> <li>Status-code-only tests stay below 35% of total</li> </ul> </li> </ul>"},{"location":"contributing/#code-style","title":"Code Style","text":"<ul> <li>Linter: ruff (runs in CI)</li> <li>Framework: FastAPI + Pydantic v2</li> <li>Storage: File-backed JSON for POC (will move to a real database on DEV)</li> <li>Sidecar: Python 3.11+ stdlib only \u2014 no external dependencies</li> </ul>"},{"location":"contributing/#what-goes-where","title":"What Goes Where","text":"Change Location Protocol endpoints <code>switchboard/v1/routes.py</code> and <code>switchboard/v1/services.py</code> Data models <code>switchboard/v1/models.py</code> Dashboard <code>dashboard/index.html</code> Sidecar <code>sidecar/switchboard-sidecar.py</code> Documentation <code>docs/</code> (MkDocs, published to GitHub Pages) Tests <code>tests/</code>"},{"location":"contributing/#using-ai-agents-to-contribute","title":"Using AI Agents to Contribute","text":"<p>We expect contributors to use AI coding agents. See AI Agent Rules for the repo-specific guardrails your agent should follow.</p>"},{"location":"dashboard/","title":"Dashboard Setup","text":"<p>Switchboard serves a fleet integrity dashboard as a single HTML page \u2014 no build tools, no JS framework, no external dependencies.</p>"},{"location":"dashboard/#accessing-the-dashboard","title":"Accessing the Dashboard","text":"<p>Start Switchboard and navigate to:</p> <pre><code>http://localhost:59237/dashboard\n</code></pre> <p>The dashboard is served directly by the Switchboard API. No separate build step or static file server needed.</p>"},{"location":"dashboard/#what-the-dashboard-shows","title":"What the Dashboard Shows","text":""},{"location":"dashboard/#fleet-overview","title":"Fleet Overview","text":"<ul> <li>Agents Registered \u2014 total count</li> <li>Avg Integrity \u2014 mean integrity score across the fleet</li> <li>Actions (24h) \u2014 total events in the last day</li> <li>Degraded \u2014 agents with integrity below threshold</li> </ul>"},{"location":"dashboard/#agent-cards","title":"Agent Cards","text":"<p>Each registered agent shows:</p> <ul> <li>Integrity score and status badge (normal / elevated / degraded / unknown)</li> <li>Network RTT and jitter from latest telemetry</li> <li>Probe source (sidecar, sensor, hook, manual)</li> <li>Runtime claims (provider, model, region)</li> <li>Last activity timestamp</li> </ul>"},{"location":"dashboard/#agent-detail-panel","title":"Agent Detail Panel","text":"<p>Click an agent card to see:</p> <p></p> <ul> <li>Tier selector \u2014 change the agent's autonomy tier (requires admin key)</li> <li>Permission grid \u2014 allowed and denied actions</li> <li>Telemetry scorecard \u2014 RTT/jitter statistics (min, max, p50, p95)</li> <li>Telemetry timeline \u2014 recent integrity scores over time</li> </ul>"},{"location":"dashboard/#tier-changes-via-dashboard","title":"Tier Changes via Dashboard","text":"<ol> <li>Click an agent card</li> <li>Enter your admin API key</li> <li>Select a new tier or integrity preset</li> <li>Changes apply immediately \u2014 the sidecar picks up the new policy on its next sync</li> </ol>"},{"location":"dashboard/#design-system","title":"Design System","text":"<p>The dashboard uses design tokens from <code>docs/shared.css</code> \u2014 a dark-theme system with desaturated teal, gold, and blue accents. See the Design System reference for the full token catalog.</p>"},{"location":"dashboard/#customization","title":"Customization","text":"<p>The dashboard is a single HTML file at <code>dashboard/index.html</code>. It fetches data from the Switchboard API using standard <code>fetch()</code> calls. You can modify it directly \u2014 no build step required.</p>"},{"location":"first-agent/","title":"Connecting Your First Agent","text":"<p>Integrate any agent with Switchboard in three steps: register, run the sidecar, emit events.</p>"},{"location":"first-agent/#overview","title":"Overview","text":"<p>Switchboard doesn't care what language your agent uses or how it's built. The integration contract is:</p> <ol> <li>Your agent reads a local policy file (written by the sidecar)</li> <li>Your agent POSTs events to localhost:9100 (forwarded by the sidecar)</li> </ol> <p>That's it. No SDK, no schema conformance, no framework adoption.</p>"},{"location":"first-agent/#step-1-register-the-agent","title":"Step 1: Register the Agent","text":"<pre><code>curl -X POST http://localhost:59237/api/v1/agents \\\n  -H \"Content-Type: application/json\" \\\n  -H \"X-Switchboard-Key: $SWITCHBOARD_API_KEY\" \\\n  -d '{\n    \"agent_id\": \"my-agent\",\n    \"display_name\": \"My First Agent\",\n    \"tier\": \"L1\",\n    \"allowed_actions\": [\"file_read\", \"api_call\"],\n    \"channels\": [\"ops\"]\n  }'\n</code></pre> <p>Save the <code>token</code> from the response \u2014 the sidecar needs it.</p>"},{"location":"first-agent/#step-2-run-the-sidecar","title":"Step 2: Run the Sidecar","text":"<pre><code>SWITCHBOARD_URL=http://localhost:59237 \\\nAGENT_ID=my-agent \\\nSIDECAR_TOKEN=swb_sk_... \\\npython sidecar/switchboard-sidecar.py\n</code></pre> <p>The sidecar will:</p> <ul> <li>Pull policy from Switchboard and write <code>policy.json</code> locally</li> <li>Start heartbeat and telemetry loops</li> <li>Listen on <code>http://localhost:9100</code> for your agent's events</li> </ul>"},{"location":"first-agent/#step-3-emit-events-from-your-agent","title":"Step 3: Emit Events from Your Agent","text":"PythonRubyGo <pre><code>import httpx\n\ndef report(action: str, target: str, result: str = \"success\"):\n    httpx.post(\"http://localhost:9100/events\", json={\n        \"action\": action,\n        \"target\": target,\n        \"result\": result,\n    })\n\n# Usage\nreport(\"file_read\", \"/data/inventory.csv\")\nreport(\"api_call\", \"https://api.example.com/status\")\n</code></pre> <pre><code>require 'net/http'\nrequire 'json'\n\ndef report(action, target, result = \"success\")\n  uri = URI(\"http://localhost:9100/events\")\n  Net::HTTP.post(uri,\n    { action: action, target: target, result: result }.to_json,\n    \"Content-Type\" =&gt; \"application/json\")\nend\n\n# Usage\nreport(\"file_read\", \"/data/inventory.csv\")\n</code></pre> <pre><code>func report(action, target, result string) error {\n    body, _ := json.Marshal(map[string]string{\n        \"action\": action, \"target\": target, \"result\": result,\n    })\n    _, err := http.Post(\"http://localhost:9100/events\",\n        \"application/json\", bytes.NewReader(body))\n    return err\n}\n</code></pre>"},{"location":"first-agent/#step-4-read-policy-optional","title":"Step 4: Read Policy (Optional)","text":"<p>The sidecar writes your agent's policy to a local file. Your agent can read it to make runtime decisions:</p> <pre><code>import json\nfrom pathlib import Path\n\npolicy = json.loads(Path(\"/switchboard/policy.json\").read_text())\nif \"delete_records\" in policy.get(\"denied_actions\", []):\n    raise PermissionError(\"Switchboard policy denies delete_records\")\n</code></pre>"},{"location":"first-agent/#verify","title":"Verify","text":"<p>Check the dashboard \u2014 your agent should appear with its tier, integrity score, and last event timestamp.</p>"},{"location":"first-agent/#next-steps","title":"Next Steps","text":"<ul> <li>Autonomy Tiers \u2014 choose the right tier for your agent</li> <li>The Sidecar Pattern \u2014 configure heartbeat, telemetry, policy format</li> <li>Protocol Specification \u2014 full event schema and API reference</li> </ul>"},{"location":"hardware/","title":"Hardware Recommendations","text":"<p>Switchboard is designed to run on modest local hardware. This page covers resource requirements and deployment considerations.</p> <p>Placeholder</p> <p>This page is under development. The content below reflects the POC deployment profile.</p>"},{"location":"hardware/#minimum-requirements","title":"Minimum Requirements","text":"<p>Switchboard and its fleet of sidecars run comfortably on:</p> Component Minimum Recommended CPU 1 core 2 cores RAM 512 MB 1 GB Disk 100 MB 1 GB (for event/telemetry logs) Python 3.11+ 3.12 Network Localhost only (POC) LAN for multi-host fleets"},{"location":"hardware/#storage-sizing","title":"Storage Sizing","text":"<p>POC storage uses file-backed JSON with automatic trimming:</p> <ul> <li>Events: Capped at 10,000 entries (~5-10 MB)</li> <li>Telemetry: Capped at 10,000 entries (~5-10 MB)</li> <li>Agent registry: Unbounded (typically &lt; 1 MB for &lt; 100 agents)</li> </ul>"},{"location":"hardware/#sidecar-overhead","title":"Sidecar Overhead","text":"<p>Each sidecar is a single Python process using only the standard library:</p> <ul> <li>Memory: ~15-30 MB per sidecar</li> <li>CPU: Negligible (HTTP calls every 30 seconds)</li> <li>Network: ~1 KB/minute per agent (heartbeats + telemetry)</li> </ul>"},{"location":"hardware/#integrity-signal-quality","title":"Integrity Signal Quality","text":"<p>For meaningful RTT-based integrity scoring, Switchboard should run on the same physical host as the agents. Network latency between Switchboard and sidecars is the primary integrity signal \u2014 running Switchboard on a remote server defeats this measurement.</p>"},{"location":"local-development/","title":"Local Development","text":"<p>Set up Switchboard for development with hot reload, testing, and linting.</p>"},{"location":"local-development/#setup","title":"Setup","text":"<pre><code>git clone https://github.com/watthem/switchboard.git\ncd switchboard\npython -m venv .venv &amp;&amp; source .venv/bin/activate\npip install -e \".[dev]\"\n</code></pre>"},{"location":"local-development/#run-with-hot-reload","title":"Run with Hot Reload","text":"<pre><code>uvicorn switchboard.app:app --port 59237 --reload\n</code></pre>"},{"location":"local-development/#run-tests","title":"Run Tests","text":"<pre><code>pytest tests/ -v --tb=short\n</code></pre> <p>All tests use isolated temp directories for storage \u2014 no cleanup needed.</p>"},{"location":"local-development/#lint","title":"Lint","text":"<pre><code>ruff check switchboard/ tests/\n</code></pre>"},{"location":"local-development/#test-quality-guard","title":"Test Quality Guard","text":"<p>A CI-integrated guard catches low-value test padding:</p> <pre><code>python3 scripts/check_test_quality.py\n</code></pre> <p>Fails on tautological asserts, zero-assert tests, and excessive status-code-only tests.</p>"},{"location":"local-development/#project-structure","title":"Project Structure","text":"<pre><code>switchboard/\n\u251c\u2500\u2500 switchboard/              # Python package\n\u2502   \u251c\u2500\u2500 app.py           # FastAPI app (~35 lines)\n\u2502   \u2514\u2500\u2500 v1/              # Governance protocol endpoints\n\u2502       \u251c\u2500\u2500 models.py    # Pydantic models\n\u2502       \u251c\u2500\u2500 routes.py    # API routes (17 endpoints)\n\u2502       \u2514\u2500\u2500 services.py  # Service layer (file-backed JSON)\n\u251c\u2500\u2500 sidecar/             # Reference sidecar (stdlib Python, zero deps)\n\u251c\u2500\u2500 dashboard/           # Fleet dashboard (single HTML file)\n\u251c\u2500\u2500 docs/                # Protocol spec, architecture, design tokens\n\u251c\u2500\u2500 examples/            # Integration examples\n\u2514\u2500\u2500 tests/               # pytest suite (78 tests)\n</code></pre>"},{"location":"local-development/#storage","title":"Storage","text":"<p>POC uses file-backed JSON in <code>data/v1/</code> (gitignored):</p> File Contents Limit <code>agents.json</code> Agent registry Unlimited <code>events.json</code> Audit log 10,000 entries <code>telemetry.json</code> Telemetry stream 10,000 entries"},{"location":"local-development/#port-map","title":"Port Map","text":"Port Service 59237 Switchboard API + Dashboard 9100 Sidecar event listener (per-agent, localhost only)"},{"location":"local-development/#environment-variables","title":"Environment Variables","text":"Variable Purpose Required <code>SWITCHBOARD_API_KEY</code> Admin API key. Unset = dev mode (no auth). No"},{"location":"protected-actions/","title":"Protected Actions &amp; Approvals","text":"<p>Switchboard controls what agents can and cannot do through policy-defined action lists and tier-level enforcement.</p>"},{"location":"protected-actions/#how-actions-work","title":"How Actions Work","text":"<p>Every event an agent emits has an <code>action</code> field \u2014 a string describing what the agent did:</p> <pre><code>{\n  \"agent_id\": \"my-agent\",\n  \"action\": \"file_write\",\n  \"target\": \"/data/report.csv\",\n  \"result\": \"success\"\n}\n</code></pre> <p>Switchboard's policy system controls which actions are allowed:</p> <pre><code>{\n  \"allowed_actions\": [\"file_read\", \"api_call\", \"send_alert\"],\n  \"denied_actions\": [\"delete_records\", \"access_credentials\"]\n}\n</code></pre>"},{"location":"protected-actions/#allowed-vs-denied-actions","title":"Allowed vs. Denied Actions","text":"Field Behavior <code>allowed_actions</code> Whitelist. If non-empty, only these actions are permitted. <code>denied_actions</code> Blacklist. These actions are always blocked, even if in the allowed list. <p>If both lists are empty, the agent can perform any action within its tier constraints.</p>"},{"location":"protected-actions/#rate-limits","title":"Rate Limits","text":"<p>Every agent has configurable rate limits:</p> <pre><code>{\n  \"rate_limits\": {\n    \"events_per_minute\": 60,\n    \"external_api_calls_per_minute\": 10\n  }\n}\n</code></pre>"},{"location":"protected-actions/#tier-level-enforcement","title":"Tier-Level Enforcement","text":"<p>Action policy works alongside tier enforcement:</p> <ul> <li>L0 agents have no write mounts \u2014 <code>file_write</code> physically cannot succeed</li> <li>L1 agents have no external network \u2014 <code>api_call</code> to outside services is blocked at the network level</li> <li>L2 agents route write actions through a human-in-the-loop gate</li> <li>L3 agents execute within policy bounds, all actions audit-logged</li> </ul>"},{"location":"protected-actions/#updating-policy","title":"Updating Policy","text":"<pre><code>curl -X PUT http://localhost:59237/api/v1/agents/my-agent/policy \\\n  -H \"Content-Type: application/json\" \\\n  -H \"X-Switchboard-Key: $SWITCHBOARD_API_KEY\" \\\n  -d '{\n    \"allowed_actions\": [\"file_read\", \"file_write\"],\n    \"denied_actions\": [\"delete_records\"],\n    \"rate_limits\": {\"events_per_minute\": 30}\n  }'\n</code></pre> <p>Policy updates increment the version number. The sidecar picks up the new policy on its next sync cycle.</p>"},{"location":"quickstart/","title":"Quickstart","text":"<p>Get Switchboard running with example agents in under 60 seconds.</p>"},{"location":"quickstart/#prerequisites","title":"Prerequisites","text":"<ul> <li>Python 3.11+</li> <li>Git</li> </ul>"},{"location":"quickstart/#1-clone-and-install","title":"1. Clone and Install","text":"<pre><code>git clone https://github.com/watthem/switchboard.git\ncd switchboard\npython -m venv .venv &amp;&amp; source .venv/bin/activate\npip install -e .\n</code></pre>"},{"location":"quickstart/#2-start-switchboard","title":"2. Start Switchboard","text":"<pre><code>uvicorn switchboard.app:app --port 59237\n</code></pre> <p>Open http://localhost:59237/dashboard \u2014 you should see an empty fleet dashboard.</p>"},{"location":"quickstart/#3-register-example-agents","title":"3. Register Example Agents","text":"<p>In a second terminal:</p> <pre><code>source .venv/bin/activate\npython examples/register-fleet.py\n</code></pre> <p>Refresh the dashboard. You'll see registered agents with their tiers and integrity status.</p>"},{"location":"quickstart/#4-run-a-sidecar","title":"4. Run a Sidecar","text":"<p>Start a sidecar for one of the registered agents:</p> <pre><code>SWITCHBOARD_URL=http://localhost:59237 \\\nAGENT_ID=my-agent \\\nSIDECAR_TOKEN=&lt;token from registration&gt; \\\npython sidecar/switchboard-sidecar.py\n</code></pre> <p>The sidecar will:</p> <ul> <li>Pull policy from Switchboard and write it locally</li> <li>Send heartbeats every 30 seconds</li> <li>Report telemetry (RTT, jitter) for integrity scoring</li> <li>Listen on <code>http://localhost:9100</code> for agent events</li> </ul>"},{"location":"quickstart/#5-send-a-test-event","title":"5. Send a Test Event","text":"<pre><code>curl -X POST http://localhost:9100/events \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"action\":\"file_read\",\"target\":\"/etc/hostname\",\"result\":\"success\"}'\n</code></pre> <p>Check the dashboard \u2014 the agent's last event and heartbeat should update.</p>"},{"location":"quickstart/#next-steps","title":"Next Steps","text":"<ul> <li>Local Development \u2014 run with <code>--reload</code>, run tests</li> <li>Connecting Your First Agent \u2014 integrate a real agent</li> <li>Autonomy Tiers \u2014 understand L0 through L3</li> </ul>"},{"location":"security/","title":"Security &amp; Air-Gapping","text":"<p>Switchboard's security model relies on infrastructure-level enforcement, not agent cooperation.</p>"},{"location":"security/#threat-model","title":"Threat Model","text":"Vector Containment Prompt injection Compromised model is trapped in its container. An L0 agent that gets injected still has no write mounts and no network. Damage ceiling is zero. Credential exfiltration Secrets live in Switchboard, not in agent containers. Agents receive processed data only. No agent can read another agent's environment. Lateral movement No direct agent-to-agent communication. All messages route through Switchboard. A compromised agent cannot discover or reach other agents. Rogue sidecar The sidecar runs as a separate process with its own auth token. Even if an agent compromises its sidecar, container-level enforcement (mounts, network) still holds."},{"location":"security/#authentication","title":"Authentication","text":""},{"location":"security/#admin-key","title":"Admin Key","text":"<p>All agent management operations require an <code>X-Switchboard-Key</code> header matching the <code>SWITCHBOARD_API_KEY</code> environment variable. When unset, Switchboard runs in dev mode with no auth \u2014 intended only for local development.</p>"},{"location":"security/#sidecar-tokens","title":"Sidecar Tokens","text":"<p>Each agent receives a unique bearer token (<code>swb_sk_...</code>) at registration. Sidecar tokens:</p> <ul> <li>Are validated on every event, telemetry, and policy request</li> <li>Are scoped to a single agent (a token for agent A cannot submit events for agent B)</li> <li>Are generated with <code>secrets.token_urlsafe(32)</code> \u2014 256 bits of entropy</li> </ul>"},{"location":"security/#integrity-scoring","title":"Integrity Scoring","text":"<p>Switchboard uses physics-based attestation to detect runtime anomalies:</p> <ul> <li>Network RTT \u2014 proves the agent runs on the expected network (localhost RTT ~1-3ms rules out remote proxying)</li> <li>Network jitter \u2014 high jitter suggests unstable or proxied connections</li> <li>Runtime claims \u2014 observed provider/model/region compared against policy expectations</li> <li>Remote session detection \u2014 flags when an agent appears to be running via a remote session</li> </ul> <p>Integrity scores use a 100-point system with penalties for violations. See Sensor Integration for adding hardware-level signals.</p>"},{"location":"security/#air-gap-deployment","title":"Air-Gap Deployment","text":"<p>Placeholder</p> <p>Full air-gap documentation is under development.</p> <p>Switchboard is designed to run on a local network with no internet dependency:</p> <ul> <li>The Switchboard API, sidecar, and dashboard have zero external network calls</li> <li>All Python dependencies can be pre-installed from a vendored wheel cache</li> <li>The dashboard is a single HTML file with no CDN imports</li> <li>Event and telemetry storage is local file-backed JSON</li> </ul> <p>For fully air-gapped environments, pre-build the Python package and transfer via secure media.</p>"},{"location":"sensor-integration/","title":"Sensor Integration Guide","text":"<p>Type: How-To Guide Audience: Engineers adding hardware-level integrity signals to a Switchboard-managed fleet Prerequisites: Switchboard running, sidecar deployed alongside agent</p>"},{"location":"sensor-integration/#overview","title":"Overview","text":"<p>The Switchboard sidecar collects two kinds of telemetry out of the box:</p> <ol> <li>Network signals \u2014 RTT and jitter measured by pinging Switchboard's <code>/health</code> endpoint</li> <li>Runtime claims \u2014 provider, model, and region declared via environment variables</li> </ol> <p>These are sufficient for most deployments. But for higher-assurance scenarios (strict integrity preset, compliance environments, trading floors), you can add a local sensor agent that measures hardware-level timing signals the sidecar can't reach on its own:</p> Signal What It Measures Why It Matters HID RTT Keyboard input \u2192 kernel \u2192 application round-trip Remote desktop adds 5-50ms+ that local input doesn't Key dwell Duration of key press/release cycle RDP/VNC buffers create uniform dwell patterns distinct from human typing OS jitter Scheduler latency (sleep accuracy) VMs and containers under load show 20-50ms variance vs ~5ms local <p>These signals are physics-based: the speed of light through fiber adds ~5 microseconds per kilometer. A trans-Pacific proxy chain introduces minimum 75ms of latency before protocol overhead. No software can fake lower latency than physics allows.</p>"},{"location":"sensor-integration/#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     localhost:7878/ws     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Sensor Agent \u2502 \u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2502   Sidecar    \u2502\n\u2502 (Rust/native)\u2502   heartbeat with signals  \u2502  (Python)    \u2502\n\u2502              \u2502                           \u2502              \u2502\n\u2502 Measures:    \u2502                           \u2502 Reads sensor \u2502\n\u2502 - HID RTT   \u2502                           \u2502 values from  \u2502\n\u2502 - Dwell      \u2502     env vars or HTTP      \u2502 env/HTTP and \u2502\n\u2502 - OS jitter  \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba   \u2502 includes in  \u2502\n\u2502 - LED RTT    \u2502                           \u2502 telemetry    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                           \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                                  \u2502\n                                          POST /api/v1/telemetry\n                                                  \u2502\n                                                  \u25bc\n                                           \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                                           \u2502   Switchboard     \u2502\n                                           \u2502  (FastAPI)   \u2502\n                                           \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>The sensor agent runs on the same host as the sidecar. It measures timing signals and makes them available to the sidecar via one of two methods:</p> <ol> <li>Environment variables (simplest) \u2014 set <code>SENSOR_HID_RTT_MS</code>, <code>SENSOR_DWELL_MS</code>, <code>SENSOR_OS_JITTER_MS</code> on the sidecar process</li> <li>HTTP/WebSocket (dynamic) \u2014 sensor agent exposes readings; a wrapper script polls and updates sidecar env</li> </ol>"},{"location":"sensor-integration/#method-1-static-environment-variables","title":"Method 1: Static Environment Variables","text":"<p>If your sensor agent writes readings to a shared file or you have baseline measurements, set the values directly on the sidecar:</p> <pre><code>SWITCHBOARD_URL=http://localhost:59237 \\\nAGENT_ID=warehouse-monitor \\\nTELEMETRY_MODE=sidecar_plus_sensor \\\nOBSERVED_PROVIDER=anthropic \\\nOBSERVED_MODEL=claude-sonnet-4-5 \\\nOBSERVED_REGION=us-west-2 \\\nSENSOR_HID_RTT_MS=12.4 \\\nSENSOR_DWELL_MS=85.2 \\\nSENSOR_OS_JITTER_MS=3.1 \\\npython switchboard-sidecar.py\n</code></pre> <p>The sidecar includes these values in every telemetry POST to Switchboard. Switchboard evaluates them against the agent's integrity policy.</p> <p>Docker Compose example:</p> <pre><code>services:\n  my-agent:\n    image: my-org/my-agent:latest\n    volumes:\n      - policy:/switchboard:ro\n\n  sensor:\n    image: switchboard/sensor-agent:latest\n    # Writes readings to shared volume\n    volumes:\n      - sensor-data:/sensor\n\n  sidecar:\n    build: ../sidecar\n    environment:\n      SWITCHBOARD_URL: http://switchboard:59237\n      AGENT_ID: my-agent\n      AGENT_TIER: L2\n      TELEMETRY_MODE: sidecar_plus_sensor\n      OBSERVED_PROVIDER: anthropic\n      OBSERVED_MODEL: claude-sonnet-4-5\n      OBSERVED_REGION: us-west-2\n      SENSOR_HID_RTT_MS: \"12.4\"\n      SENSOR_DWELL_MS: \"85.2\"\n      SENSOR_OS_JITTER_MS: \"3.1\"\n    volumes:\n      - policy:/switchboard\n\nvolumes:\n  policy:\n  sensor-data:\n</code></pre>"},{"location":"sensor-integration/#method-2-dynamic-sensor-polling","title":"Method 2: Dynamic Sensor Polling","text":"<p>For live readings, run a wrapper that polls the sensor agent and restarts/updates the sidecar with fresh values. This is the pattern used by the lag-heart native agent:</p> <pre><code>#!/bin/bash\n# poll-sensor.sh \u2014 reads sensor, exports to sidecar env\nSENSOR_URL=\"http://localhost:7878\"\n\nwhile true; do\n  readings=$(curl -s \"$SENSOR_URL/readings\" 2&gt;/dev/null)\n  if [ $? -eq 0 ] &amp;&amp; [ -n \"$readings\" ]; then\n    export SENSOR_HID_RTT_MS=$(echo \"$readings\" | python3 -c \"import sys,json; print(json.load(sys.stdin).get('hid_rtt_ms',''))\")\n    export SENSOR_DWELL_MS=$(echo \"$readings\" | python3 -c \"import sys,json; print(json.load(sys.stdin).get('avg_dwell_ms',''))\")\n    export SENSOR_OS_JITTER_MS=$(echo \"$readings\" | python3 -c \"import sys,json; print(json.load(sys.stdin).get('os_jitter_ms',''))\")\n  fi\n  sleep 10\ndone\n</code></pre> <p>The sidecar reads <code>SENSOR_*</code> env vars on each telemetry cycle, so updating them in the process environment takes effect at the next interval.</p>"},{"location":"sensor-integration/#sensor-signal-formats","title":"Sensor Signal Formats","text":"<p>All sensor values are floating-point milliseconds:</p> Env Var Type Valid Range Example <code>SENSOR_HID_RTT_MS</code> float 0.1 - 500.0 <code>12.4</code> <code>SENSOR_DWELL_MS</code> float 5.0 - 500.0 <code>85.2</code> <code>SENSOR_OS_JITTER_MS</code> float 0.1 - 100.0 <code>3.1</code> <p>Values outside valid ranges are included but may trigger integrity warnings.</p>"},{"location":"sensor-integration/#telemetry-mode","title":"Telemetry Mode","text":"<p>Set <code>TELEMETRY_MODE</code> to tell Switchboard what kind of signals to expect:</p> Mode Description When to Use <code>sidecar_only</code> Network RTT/jitter + runtime claims only Default. No sensor agent deployed. <code>sidecar_plus_sensor</code> All sidecar signals plus HID/dwell/OS jitter Sensor agent is running alongside sidecar. <p>Switchboard uses this to set appropriate baselines. A <code>sidecar_plus_sensor</code> agent with missing sensor signals will show as <code>elevated</code> rather than <code>unknown</code>.</p>"},{"location":"sensor-integration/#integrity-policy-presets","title":"Integrity Policy Presets","text":"<p>Presets define thresholds for telemetry signals:</p> Preset RTT Limit Jitter Limit Remote Allowed Sensor Required Relaxed 240 ms 70 ms Yes No Standard 120 ms 30 ms No No Strict 70 ms 18 ms No Yes (<code>sidecar_plus_sensor</code>) <p>Apply presets via the dashboard or API:</p> <pre><code># Apply strict preset to one agent\ncurl -X POST http://localhost:59237/api/v1/agents/warehouse-monitor/policy/preset \\\n  -H \"Content-Type: application/json\" \\\n  -H \"X-Switchboard-Key: $SWITCHBOARD_API_KEY\" \\\n  -d '{\"preset\": \"strict\", \"pin_observed_claims\": true}'\n\n# Apply standard preset to all agents\ncurl -X POST http://localhost:59237/api/v1/fleet/policy/preset \\\n  -H \"Content-Type: application/json\" \\\n  -H \"X-Switchboard-Key: $SWITCHBOARD_API_KEY\" \\\n  -d '{\"preset\": \"standard\", \"pin_observed_claims\": false}'\n</code></pre> <p>The <code>pin_observed_claims</code> flag locks the agent's currently observed provider, model, and region into its integrity policy. Any drift from those values triggers an integrity score penalty.</p>"},{"location":"sensor-integration/#building-a-sensor-agent","title":"Building a Sensor Agent","text":"<p>If you're building your own sensor agent (rather than using the reference implementation), expose these signals:</p> <p>Minimum viable sensor \u2014 just HID timing:</p> <pre><code># Example: Python sensor that measures keyboard dwell\nimport time\nfrom pynput import keyboard\n\ndwell_samples = []\npress_times = {}\n\ndef on_press(key):\n    press_times[key] = time.perf_counter()\n\ndef on_release(key):\n    if key in press_times:\n        dwell = (time.perf_counter() - press_times.pop(key)) * 1000\n        dwell_samples.append(dwell)\n        if len(dwell_samples) &gt; 100:\n            dwell_samples.pop(0)\n\n# Expose via HTTP for sidecar polling\n# GET /readings \u2192 {\"avg_dwell_ms\": 82.5, \"sample_count\": 47}\n</code></pre> <p>Full sensor \u2014 see the Rust reference agent at <code>~/git/lag-heart/agent/</code> for HID, OS jitter, LED loopback, and remote-session detection.</p>"},{"location":"sensor-integration/#verifying-integration","title":"Verifying Integration","text":"<p>Once the sidecar is running with sensor signals:</p> <ol> <li>Check the dashboard at <code>http://localhost:59237/dashboard</code></li> <li>Select your agent card \u2014 the metric grid should show HID RTT, Dwell, and OS Jitter values</li> <li>The scorecard table shows rolling statistics (latest, mean, p50, p95, min, max)</li> <li>The integrity badge should reflect the agent's score against its policy</li> </ol> <p>API check:</p> <pre><code># Query telemetry for a specific agent\ncurl \"http://localhost:59237/api/v1/fleet/telemetry?agent_id=warehouse-monitor&amp;limit=5\"\n</code></pre> <p>The response includes per-sample integrity evaluations with <code>integrity_status</code>, <code>integrity_score</code>, and <code>integrity_reasons</code>.</p>"},{"location":"sidecar/","title":"The Sidecar Pattern","text":"<p>The sidecar is the bridge between your agent and Switchboard. It handles all protocol communication so your agent doesn't have to.</p>"},{"location":"sidecar/#what-the-sidecar-does","title":"What the Sidecar Does","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Your Agent Container    \u2502\n\u2502                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502Agent \u2502\u2500\u2500\u2502 Sidecar   \u2502\u2500\u253c\u2500\u2500\u2500\u2500 Switchboard API\n\u2502  \u2502(any) \u2502  \u2502 (Python)  \u2502 \u2502     (port 59237)\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502     \u25b2           \u2502        \u2502\n\u2502     \u2502    policy.json     \u2502\n\u2502     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>The sidecar:</p> <ol> <li>Pulls policy from Switchboard and writes it as a local file your agent reads</li> <li>Forwards events from your agent (localhost:9100) to Switchboard</li> <li>Sends heartbeats every 30 seconds to prove the agent is alive</li> <li>Reports telemetry (network RTT, jitter, runtime claims) for integrity scoring</li> </ol>"},{"location":"sidecar/#running-the-sidecar","title":"Running the Sidecar","text":"<pre><code>SWITCHBOARD_URL=http://localhost:59237 \\\nAGENT_ID=my-agent \\\nSIDECAR_TOKEN=swb_sk_... \\\npython sidecar/switchboard-sidecar.py\n</code></pre>"},{"location":"sidecar/#configuration","title":"Configuration","text":"<p>All configuration is via environment variables:</p> Variable Default Description <code>SWITCHBOARD_URL</code> <code>http://localhost:59237</code> Switchboard API endpoint <code>AGENT_ID</code> (required) Agent identifier <code>SIDECAR_TOKEN</code> (required) Bearer token from registration <code>SWITCHBOARD_API_KEY</code> Admin key (for auto-registration) <code>POLICY_FORMAT</code> <code>json</code> Policy file format: <code>json</code>, <code>yaml</code>, <code>env</code>, <code>toml</code> <code>POLICY_PATH</code> <code>/switchboard/policy.json</code> Where to write the policy file <code>EVENT_LISTEN_PORT</code> <code>9100</code> Port for agent event submissions <code>HEARTBEAT_INTERVAL</code> <code>30</code> Seconds between heartbeats <code>TELEMETRY_INTERVAL</code> <code>30</code> Seconds between telemetry reports <code>TELEMETRY_MODE</code> <code>sidecar_only</code> <code>sidecar_only</code> or <code>sidecar_plus_sensor</code> <code>OBSERVED_PROVIDER</code> Runtime claim: AI provider (e.g., <code>anthropic</code>) <code>OBSERVED_MODEL</code> Runtime claim: model name <code>OBSERVED_REGION</code> Runtime claim: deployment region"},{"location":"sidecar/#policy-formats","title":"Policy Formats","text":"<p>The sidecar writes policy in whatever format your agent prefers:</p> JSONYAMLEnvironment <pre><code>{\n  \"agent_id\": \"my-agent\",\n  \"tier\": \"L2\",\n  \"allowed_actions\": [\"file_read\", \"api_call\"],\n  \"denied_actions\": [\"delete_records\"]\n}\n</code></pre> <pre><code>agent_id: my-agent\ntier: L2\nallowed_actions:\n  - file_read\n  - api_call\ndenied_actions:\n  - delete_records\n</code></pre> <pre><code>SWITCHBOARD_AGENT_ID=my-agent\nHERALD_TIER=L2\nHERALD_ALLOWED_ACTIONS=file_read,api_call\nHERALD_DENIED_ACTIONS=delete_records\n</code></pre>"},{"location":"sidecar/#auto-registration","title":"Auto-Registration","text":"<p>If you provide <code>SWITCHBOARD_API_KEY</code> instead of <code>SIDECAR_TOKEN</code>, the sidecar will register the agent automatically and store the token:</p> <pre><code>SWITCHBOARD_URL=http://localhost:59237 \\\nAGENT_ID=new-agent \\\nSWITCHBOARD_API_KEY=your-admin-key \\\nAGENT_TIER=L1 \\\npython sidecar/switchboard-sidecar.py\n</code></pre>"},{"location":"sidecar/#zero-dependencies","title":"Zero Dependencies","text":"<p>The reference sidecar uses only Python 3.11+ standard library. No pip install needed. Copy it into any container that has Python.</p>"},{"location":"sidecar/#writing-your-own-sidecar","title":"Writing Your Own Sidecar","text":"<p>The sidecar protocol is simple enough to reimplement in any language. It needs to:</p> <ol> <li><code>GET /api/v1/agents/{id}/policy</code> with Bearer token \u2014 pull policy</li> <li><code>POST /api/v1/events</code> with Bearer token \u2014 forward events</li> <li><code>POST /api/v1/telemetry</code> with Bearer token \u2014 report telemetry</li> <li>Listen on a local port for agent event POSTs</li> </ol> <p>See the Protocol Specification for the full API contract.</p>"},{"location":"trust-boundary/","title":"The Trust Boundary","text":"<p>Switchboard manages the box, not the code inside it.</p>"},{"location":"trust-boundary/#the-problem","title":"The Problem","text":"<p>AI agents are easy to run and hard to govern. Every team builds agents in their own stack \u2014 Python, Ruby, Go, TypeScript, custom frameworks. There is no standard way to answer three questions that every security team asks before approving deployment:</p> <ol> <li>What can this agent access? (least-privilege)</li> <li>What did this agent do? (audit trail)</li> <li>Who authorized it? (accountability)</li> </ol> <p>Today's answers are \"everything,\" \"we don't know,\" and \"nobody.\"</p>"},{"location":"trust-boundary/#switchboards-approach","title":"Switchboard's Approach","text":"<p>Like Kubernetes doesn't care if your service is written in Go, Java, or Python \u2014 it manages the container \u2014 Switchboard doesn't care how your agent is built. It manages the boundary: what the agent can access, what events it emits, and what policy governs it.</p> <p>The interface between Switchboard and any agent is a contract at the infrastructure level, not a language-specific SDK or schema standard.</p>"},{"location":"trust-boundary/#what-this-means-in-practice","title":"What This Means in Practice","text":"Vector Without Switchboard With Switchboard Prompt injection Compromised model has whatever access the developer gave it Compromised model is trapped in its container. An L0 agent that gets injected still has no write mounts and no network. Credential exfiltration Secrets live in agent env vars Secrets live in Switchboard, not in agent containers. Agents receive processed data only. Lateral movement Agents can discover and call other services No direct agent-to-agent communication. All messages route through Switchboard. Rogue sidecar No sidecar exists Even if compromised, container-level enforcement (mounts, network) still holds."},{"location":"trust-boundary/#what-switchboard-is-not","title":"What Switchboard Is Not","text":"<p>Switchboard is not a model safety tool. It does not evaluate prompt quality, detect hallucinations, or filter model outputs. It enforces infrastructure-level access control \u2014 what an agent can do, regardless of what the model wants to do.</p> <p>Switchboard is not an agent framework. It does not prescribe how agents are built, what language they use, or what schema they prefer. It manages the boundary around agents that already exist.</p>"}]}